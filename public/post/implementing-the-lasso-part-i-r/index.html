<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.53" />
  <meta name="author" content="Øystein Sørensen">

  
  
  
  
    
  
  <meta name="description" content="In a previous post, I briefly described the Lasso, and my plan for implementing it in twelve languages in 2019. To start out easily, and have a reference, I am beginning with R. I am not going to use any external dependencies, i.e., no calls to library(). This is obviously not how we we do it in real life, but really useful in order to understand what the algorithm really does.">

  
  <link rel="alternate" hreflang="en-us" href="/post/implementing-the-lasso-part-i-r/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" crossorigin="anonymous">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700|Roboto:400,400italic,700|Roboto+Mono">
  

  <link rel="stylesheet" href="/styles.css">
  

  
  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-131472259-1', 'auto');
      
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Øystein Sørensen">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="Øystein Sørensen">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/post/implementing-the-lasso-part-i-r/">

  
  
  
  
    
    
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@SorensenOystein">
  <meta property="twitter:creator" content="@SorensenOystein">
  
  <meta property="og:site_name" content="Øystein Sørensen">
  <meta property="og:url" content="/post/implementing-the-lasso-part-i-r/">
  <meta property="og:title" content="Implementing the Lasso, Part I: R | Øystein Sørensen">
  <meta property="og:description" content="In a previous post, I briefly described the Lasso, and my plan for implementing it in twelve languages in 2019. To start out easily, and have a reference, I am beginning with R. I am not going to use any external dependencies, i.e., no calls to library(). This is obviously not how we we do it in real life, but really useful in order to understand what the algorithm really does."><meta property="og:image" content="/img/portrait.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2018-12-28T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2018-12-28T00:00:00&#43;00:00">
  

  

  

  <title>Implementing the Lasso, Part I: R | Øystein Sørensen</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" role="textbox" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Øystein Sørensen</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>Home</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#posts">
            
            <span>Posts</span>
            
          </a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Implementing the Lasso, Part I: R</h1>

  

  
    

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Øystein Sørensen">
  </span>
  

  <span class="article-date">
    
    <meta content="2018-12-28 00:00:00 &#43;0000 UTC" itemprop="datePublished">
    <time datetime="2018-12-28 00:00:00 &#43;0000 UTC" itemprop="dateModified">
      Dec 28, 2018
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Øystein Sørensen">
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    6 min read
  </span>
  

  
  
  <span class="middot-divider"></span>
  <a href="/post/implementing-the-lasso-part-i-r/#disqus_thread"></a>
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder"></i>
    
    <a href="/categories/machine-learning/">Machine Learning</a>, 
    
    <a href="/categories/statistics/">Statistics</a>
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Implementing%20the%20Lasso%2c%20Part%20I%3a%20R&amp;url=%2fpost%2fimplementing-the-lasso-part-i-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2fimplementing-the-lasso-part-i-r%2f"
         target="_blank" rel="noopener">
        <i class="fab fa-facebook-f"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2fimplementing-the-lasso-part-i-r%2f&amp;title=Implementing%20the%20Lasso%2c%20Part%20I%3a%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2fimplementing-the-lasso-part-i-r%2f&amp;title=Implementing%20the%20Lasso%2c%20Part%20I%3a%20R"
         target="_blank" rel="noopener">
        <i class="fab fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Implementing%20the%20Lasso%2c%20Part%20I%3a%20R&amp;body=%2fpost%2fimplementing-the-lasso-part-i-r%2f">
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    















  
</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      


<p>In a <a href="http://osorensen.rbind.io/post/lasso-in-12-languages/">previous post</a>, I briefly described the Lasso, and my plan for implementing it in twelve languages in 2019. To start out easily, and have a reference, I am beginning with R. I am not going to use any external dependencies, i.e., no calls to <code>library()</code>. This is obviously not how we we do it in real life, but really useful in order to understand what the algorithm really does. Also, anyone who has tried to convince an IT department in a large corporation to install R packages, or installing a package with lots of dependencies on a high-performance computing cluster, knows the value of base R.</p>
<div id="download-data" class="section level2">
<h2>Download Data</h2>
<p>First, we need to download the <a href="http://lib.stat.cmu.edu/datasets/boston">Boston housing dataset</a>, which we are going to analyze. We start by reading in all the lines.</p>
<pre class="r"><code>vars &lt;- scan(file = &quot;http://lib.stat.cmu.edu/datasets/boston&quot;, 
             what = character(), sep = &quot;\n&quot;, strip.white = TRUE)</code></pre>
<p>Next, we extract the variable names, which start at the line “Variables in order”. We deleted everything up to this index.</p>
<pre class="r"><code>start_index &lt;- grep(&quot;Variables in order&quot;, vars)
vars &lt;- vars[- seq(1, start_index, 1)]</code></pre>
<p>Starting here, we add variable names until we reach a numeric. Performance of this tiny loop is not an issue, so I am growing the vector.</p>
<pre class="r"><code>names &lt;- character()
while(TRUE){
  # Find location of first non-upper case letter
  end &lt;- regexpr(&quot;[^[:upper:]]&quot;, vars[[1]])
  # Break out of loop if first letter is not uppercase
  if(end &lt;= 1) {
    break
  } else {
    new_name &lt;- substr(vars[[1]], 1, end - 1)
    names &lt;- c(names, new_name)  
  }
  # Delete the item, and move to the next
  vars &lt;- vars[-1]
}</code></pre>
<p>These are the variable names:</p>
<pre class="r"><code>names</code></pre>
<pre><code>##  [1] &quot;CRIM&quot;    &quot;ZN&quot;      &quot;INDUS&quot;   &quot;CHAS&quot;    &quot;NOX&quot;     &quot;RM&quot;      &quot;AGE&quot;    
##  [8] &quot;DIS&quot;     &quot;RAD&quot;     &quot;TAX&quot;     &quot;PTRATIO&quot; &quot;B&quot;       &quot;LSTAT&quot;   &quot;MEDV&quot;</code></pre>
<p>Now we have come to the numeric values, which are printed below:</p>
<pre class="r"><code>head(vars)</code></pre>
<pre><code>## [1] &quot;0.00632  18.00   2.310  0  0.5380  6.5750  65.20  4.0900   1  296.0  15.30&quot;
## [2] &quot;396.90   4.98  24.00&quot;                                                      
## [3] &quot;0.02731   0.00   7.070  0  0.4690  6.4210  78.90  4.9671   2  242.0  17.80&quot;
## [4] &quot;396.90   9.14  21.60&quot;                                                      
## [5] &quot;0.02729   0.00   7.070  0  0.4690  7.1850  61.10  4.9671   2  242.0  17.80&quot;
## [6] &quot;392.83   4.03  34.70&quot;</code></pre>
<p>There is one issue here, namely that each data point takes up two lines. We handle this by reading the number of variables in <code>vars</code> into each row.</p>
<p>We first split the values by one or more space.</p>
<pre class="r"><code>values &lt;- strsplit(vars, split = &quot;[[:space:]]+&quot;)
head(values, 2)</code></pre>
<pre><code>## [[1]]
##  [1] &quot;0.00632&quot; &quot;18.00&quot;   &quot;2.310&quot;   &quot;0&quot;       &quot;0.5380&quot;  &quot;6.5750&quot;  &quot;65.20&quot;  
##  [8] &quot;4.0900&quot;  &quot;1&quot;       &quot;296.0&quot;   &quot;15.30&quot;  
## 
## [[2]]
## [1] &quot;396.90&quot; &quot;4.98&quot;   &quot;24.00&quot;</code></pre>
<p>We then unlist and convert to a numeric vector.</p>
<pre class="r"><code>values &lt;- as.numeric(unlist(values))
head(values)</code></pre>
<pre><code>## [1]  0.00632 18.00000  2.31000  0.00000  0.53800  6.57500</code></pre>
<p>Finally, we convert to a matrix and set the column names.</p>
<pre class="r"><code>values &lt;- matrix(values, ncol = length(names), byrow = TRUE,
                 dimnames = list(NULL, names))</code></pre>
<p>Now we have our dataset:</p>
<pre class="r"><code>head(values)</code></pre>
<pre><code>##         CRIM ZN INDUS CHAS   NOX    RM  AGE    DIS RAD TAX PTRATIO      B
## [1,] 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90
## [2,] 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90
## [3,] 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83
## [4,] 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63
## [5,] 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90
## [6,] 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12
##      LSTAT MEDV
## [1,]  4.98 24.0
## [2,]  9.14 21.6
## [3,]  4.03 34.7
## [4,]  2.94 33.4
## [5,]  5.33 36.2
## [6,]  5.21 28.7</code></pre>
<p>We can finish off by extracting the response <span class="math inline">\(y\)</span> and the covariates <span class="math inline">\(X\)</span>:</p>
<pre class="r"><code>X &lt;- values[, setdiff(colnames(values), &quot;MEDV&quot;)]
y &lt;- values[, &quot;MEDV&quot;]</code></pre>
</div>
<div id="standardize-variables" class="section level2">
<h2>Standardize Variables</h2>
<p>Considering the lasso criterion,</p>
<p><span class="math display">\[\hat{\beta} = \text{arg}~\text{min}_{\beta} \left\| y - X \beta\right\|_{2}^{2} + \lambda \left\|\beta\right\|_{1}\]</span>
it is clear the if the columns of <span class="math inline">\(X\)</span> do not have equal variance, then the columns with high variance will be penalized more than the columns with low variance, since the regularization parameter <span class="math inline">\(\lambda\)</span> is the same for all of them. The common way of dealing with this is by a reparametrization, where we instead compute</p>
<p><span class="math display">\[\tilde{\beta} = \sigma_{X} \odot \hat{\beta}\]</span></p>
<p>where <span class="math inline">\(\sigma_{X}\)</span> is the vector of standard deviations of the columns of <span class="math inline">\(X\)</span>, and <span class="math inline">\(\odot\)</span> is the elementwise product. We standardize <span class="math inline">\(X\)</span>, compute <span class="math inline">\(\tilde{\beta}\)</span> and then find <span class="math inline">\(\hat{\beta}\)</span> by dividing by <span class="math inline">\(\sigma_{X}\)</span>. In addition, we would like to center all the variables by subtracting their mean and doing the same with <span class="math inline">\(y\)</span>. The intercept of the model is then just the sum of <span class="math inline">\(y\)</span>. The base R <code>scale()</code> function does the job. The values we need are stored in the attributes of <code>Xsc</code>:</p>
<pre class="r"><code>attr(scale(X), &quot;scaled:scale&quot;)</code></pre>
<pre><code>##        CRIM          ZN       INDUS        CHAS         NOX          RM 
##   8.6015451  23.3224530   6.8603529   0.2539940   0.1158777   0.7026171 
##         AGE         DIS         RAD         TAX     PTRATIO           B 
##  28.1488614   2.1057101   8.7072594 168.5371161   2.1649455  91.2948644 
##       LSTAT 
##   7.1410615</code></pre>
<pre class="r"><code>attr(scale(y, scale = FALSE), &quot;scaled:center&quot;)</code></pre>
<pre><code>## [1] 22.53281</code></pre>
<p>We will actually implement this with the lasso function below.</p>
</div>
<div id="coordinate-descent" class="section level2">
<h2>Coordinate Descent</h2>
<p>The main part of the coordinate descent algorithm is the soft-thresholding function. It is defined as <span class="math inline">\(S(t, \lambda) = \text{sign}(t)(|t| - \lambda)_{+}\)</span>, <a href="https://web.stanford.edu/~hastie/Papers/ESLII.pdf">cf. ESLII, p. 93</a>. We implement it as follows.</p>
<pre class="r"><code>soft_threshold &lt;- function(t, lambda){
  test &lt;- abs(t) - lambda
  sign(t) * ifelse(test &gt; 0, test, 0) 
}</code></pre>
<p>The plot below illustrates how it works.</p>
<pre class="r"><code>lambda &lt;- 1
t &lt;- seq(from = -2, to = 2, by = 0.1)
plot(t, soft_threshold(t, lambda), type = &quot;l&quot;,
     ylab = expression(S(t, lambda)),
     main = &quot;Soft thresholding operator&quot;)
abline(a = 0, b = 0, lty = 2)</code></pre>
<p><img src="/post/2018-12-28-implementing-the-lasso-part-i-r_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>This also summarizes how the lasso works. If a coefficient is too small, it is set exactly to zero!</p>
<p>Next, we need to implement the actual coordinate descent algorithm taking <span class="math inline">\(X\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(\lambda\)</span> as input. It returns an estimate of <span class="math inline">\(\beta\)</span>.</p>
<pre class="r"><code>coordinate_descent &lt;- function(X, y, lambda, 
                               tol = 1e-7, maxit = 1000){
  # Number of coefficients
  p &lt;- ncol(X)
  # Initial value of beta
  beta &lt;- rep(0, ncol(X))
  # Control parameters to avoid an infinite loop
  eps &lt;- 100
  control &lt;- 0
  
  while(eps &gt; tol &amp;&amp; control &lt; maxit){
    beta_old &lt;- beta
    # Loop around the coefficients
    for(j in seq(from = 1, to = p, by = 1)){
      # Current partial residual
      pres &lt;- (y - X[, -j, drop = FALSE] %*% beta[-j])
      # Sum to soft-threshold
      t &lt;- mean(X[, j] * pres)
      # Update current beta
      beta[j] &lt;- soft_threshold(t, lambda)
    }
    eps &lt;- sum(abs(beta - beta_old))
    control &lt;- control + 1
  }
  return(beta)
}</code></pre>
<p>We are now ready to compute the lasso.</p>
<pre class="r"><code>lasso &lt;- function(X, y, lambda){
  # Scale and center X
  X &lt;- scale(X)
  # Center y
  y &lt;- scale(y, scale = FALSE)
  # Run the lasso
  beta &lt;- coordinate_descent(X, y, lambda)
  # Transform coordinates
  beta &lt;- beta / attr(X, &quot;scaled:scale&quot;)
  # Add intercept
  beta &lt;- c(attr(y, &quot;scaled:center&quot;), beta)
  # Add names
  names(beta) &lt;- c(&quot;Intercept&quot;, colnames(X))  
  # Return beta
  return(beta)
}</code></pre>
<p>In the glmnet fit from the introductory blogpost, the minimized prediction error was achieved at around <span class="math inline">\(\log(\lambda) = -1\)</span>. We hence try this.</p>
<pre class="r"><code>round(lasso(X, y, lambda = exp(-1)), 3)</code></pre>
<pre><code>## Intercept      CRIM        ZN     INDUS      CHAS       NOX        RM 
##    22.533    -0.023     0.000     0.000     1.929    -3.728     4.266 
##       AGE       DIS       RAD       TAX   PTRATIO         B     LSTAT 
##     0.000    -0.339     0.000     0.000    -0.791     0.007    -0.517</code></pre>
<p>Comparing to the glmnet fit, this seems to be at the right order of magnitude. Until further, the implementation seems sound, so we go on to cross-validation, which should give very close to glmnet-fit.</p>
</div>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/lasso2019/">Lasso2019</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="/img/portrait.jpg" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="/">Øystein Sørensen</a></h5>
    <h6 class="card-subtitle">Associate Professor of Statistics</h6>
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
        
      
      
      
      
      
      <li>
        <a itemprop="sameAs" href="mailto:oystein.sorensen@psykologi.uio.no" >
          <i class="fas fa-envelope"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://twitter.com/SorensenOystein" target="_blank" rel="noopener">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://scholar.google.no/citations?user=neOqbw0AAAAJ&amp;hl=no" target="_blank" rel="noopener">
          <i class="ai ai-google-scholar"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://github.com/osorensen" target="_blank" rel="noopener">
          <i class="fab fa-github"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    
    <div class="article-widget">
      <div class="hr-light"></div>
      <h3>Related</h3>
      <ul>
        
        <li><a href="/post/lasso-in-12-languages/">Lasso in Twelve Languages</a></li>
        
      </ul>
    </div>
    

    

    
<section id="comments">
  <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "osorensen" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



  </div>
</article>

<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    &copy; 2018 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    
    <script id="dsq-count-scr" src="//osorensen.disqus.com/count.js" async></script>
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Search...",
        'results': "results found",
        'no_results': "No results found"
      };
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>

